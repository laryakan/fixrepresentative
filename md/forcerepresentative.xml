<?xml version="1.0" encoding="utf-8"?>
<!-- FORCE REPRESENTATIVE SCRIPT for Fix Representative mod by Laryakan, 15th of May 2025 -->
<!-- Github : https://github.com/laryakan/fixrepresentative -->
<!-- Nexus : https://www.nexusmods.com/x4foundations/mods/1702 -->
<mdscript xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="md.xsd" name="ForceRepresentative">
	<cues>
		<cue name="ForceRepresentative_Start" instantiate="true" namespace="this" >
			<conditions>
				<check_any>
					<!-- CHECK 1 TIME AT START -->
					<event_cue_signalled cue="md.Setup.Start" />
					<!-- CHECK 1 TIME AT GAMELOAD -->
					<!-- the script should run when loading a save because of md.Setup.Start, check it up -->
					<!-- <event_cue_signalled cue="md.Setup.GameLoaded" /> -->
				</check_any>
			</conditions>
			<delay exact="10s" />
			<actions>
				<show_notification text="'Dispatching the Missing Representative Task Force, aka MRTF...'"/>
				<!-- Iterate over all registered factions -->
				<do_for_each name="$Faction" in="md.$FactionData">
					<debug_text text="'ForceRepresentative - Interate on : ' + $Faction" />
					<!-- ARGON CHECK -->
					<do_if value="$Faction == faction.argon">
						<signal_cue_instantly cue="arg" />
					</do_if>
					<!-- ANTIGONE CHECK -->
					<do_if value="$Faction == faction.antigone">
						<signal_cue_instantly cue="ant" />
					</do_if>
					<!-- HATIKVAH CHECK -->
					<do_if value="$Faction == faction.hatikvah">
						<signal_cue_instantly cue="hat" />
					</do_if>
					<!-- TELADI CHECK -->
					<do_if value="$Faction == faction.teladi">
						<signal_cue_instantly cue="tel" />
					</do_if>
					<!-- MINISTRY CHECK -->
					<do_if value="$Faction == faction.ministry">
						<signal_cue_instantly cue="ministry" />
					</do_if>
					<!-- SCALEPLATE CHECK -->
					<do_if value="$Faction == faction.scaleplate">
						<signal_cue_instantly cue="sca" />
					</do_if>
					<!-- PARANID CHECK -->
					<do_if value="$Faction == faction.paranid">
						<signal_cue_instantly cue="par" />
					</do_if>
					<!-- HOLY ORDER CHECK -->
					<do_if value="$Faction == faction.holyorder">
						<signal_cue_instantly cue="hop" />
					</do_if>
					<!-- ALLIANCE CHECK -->
					<do_if value="$Faction == faction.alliance">
						<signal_cue_instantly cue="ali" />
					</do_if>
					<!-- XENON ??? Nope... -->
					<!--
					<do_if value="$Faction == faction.xenon">
						<signal_cue_instantly cue="xen" />
						<reset_cue cue="xen" />
					</do_if> 
					-->
					<!-- BUCCANEERS CHECK -->
					<do_if value="$Faction == faction.buccaneers">
						<signal_cue_instantly cue="duk" />
					</do_if>
					<!-- TRINITY CHECK -->
					<do_if value="$Faction == faction.trinity">
						<signal_cue_instantly cue="tri" />
					</do_if>
					<!-- ZYARTH CHECK -->
					<do_if value="$Faction == faction.split">
						<signal_cue_instantly cue="zya" />
					</do_if>
					<!-- FREE FAMILIES CHECK -->
					<do_if value="$Faction == faction.freesplit">
						<signal_cue_instantly cue="frf" />
					</do_if>
					<!-- COURT OF CURBS CHECK -->
					<do_if value="$Faction == faction.court">
						<signal_cue_instantly cue="cub" />
					</do_if>
					<!-- FALLEN FAMILIES CHECK -->
					<do_if value="$Faction == faction.fallensplit">
						<signal_cue_instantly cue="faf" />
					</do_if>
					<!-- TERRAN CHECK -->
					<do_if value="$Faction == faction.terran">
						<signal_cue_instantly cue="ter" />
					</do_if>
					<!-- PIONEERS CHECK -->
					<do_if value="$Faction == faction.pioneers">
						<signal_cue_instantly cue="pio" />
					</do_if>
					<!-- YAKI CHECK -->
					<do_if value="$Faction == faction.yaki">
						<signal_cue_instantly cue="yak" />
					</do_if>
					<!-- VIGOR SYNDICATE CHECK -->
					<do_if value="$Faction == faction.loanshark">
						<signal_cue_instantly cue="vig" />
					</do_if>
					<!-- RIPTIDE RACKERS CHECK -->
					<do_if value="$Faction == faction.scavenger">
						<signal_cue_instantly cue="rip" />
					</do_if>
					<!-- BORON CHECK -->
					<do_if value="$Faction == faction.boron">
						<signal_cue_instantly cue="bor" />
					</do_if>
					<!-- QUETTANAUTS CHECK -->
					<do_if value="$Faction == faction.kaori">
						<signal_cue_instantly cue="que" />
					</do_if>
				</do_for_each>
				<reset_cue cue="this" />
			</actions>
			<cues>
				<!-- ===== DATA TRANSFER OBJECT (DTO) CUE, TO STORE ALL NEEDED EXTENDED SCOPE VARIABLE WITHOUT SIDE EFFECTS ===== -->
				<!-- ARGON DTO -->
				<cue name="arg" instantiate="true">
					<conditions>
						<event_cue_signalled />
					</conditions>
					<actions>
						<set_value name="$Faction" exact="faction.argon" />
						<debug_text text="'ForceRepresentative - in DTO for for : ' + $Faction" />
						<set_value name="$SearchSpace" exact="player.galaxy" />
						<!-- this cue will serve to store every variable in next called cues -->
						<signal_cue_instantly cue="spawn" param="namespace" />
						<reset_cue cue="this" />
					</actions>
				</cue>
				
				<!-- ANTIGONE DTO -->
				<cue name="ant" instantiate="true">
					<conditions>
						<event_cue_signalled />
					</conditions>
					<actions>
						<set_value name="$Faction" exact="faction.antigone" />
						<debug_text text="'ForceRepresentative - in DTO for for : ' + $Faction" />
						<set_value name="$SearchSpace" exact="player.galaxy" />
						<!-- this cue will serve to store every variable in next called cues -->
						<signal_cue_instantly cue="spawn" param="namespace" />
						<reset_cue cue="this" />
					</actions>
				</cue>
				
				<!-- HATIKVAH DTO -->
				<cue name="hat" instantiate="true">
					<conditions>
						<event_cue_signalled />
					</conditions>
					<actions>
						<set_value name="$Faction" exact="faction.hatikvah" />
						<debug_text text="'ForceRepresentative - in DTO for for : ' + $Faction" />
						<set_value name="$SearchSpace" exact="player.galaxy" />
						<!-- this cue will serve to store every variable in next called cues -->
						<signal_cue_instantly cue="spawn" param="namespace" />
						<reset_cue cue="this" />
					</actions>
				</cue>
				
				<!-- TELADI DTO -->
				<cue name="tel" instantiate="true">
					<conditions>
						<event_cue_signalled />
					</conditions>
					<actions>
						<set_value name="$Faction" exact="faction.teladi" />
						<debug_text text="'ForceRepresentative - in DTO for for : ' + $Faction" />
						<set_value name="$SearchSpace" exact="player.galaxy" />
						<!-- this cue will serve to store every variable in next called cues -->
						<signal_cue_instantly cue="spawn" param="namespace" />
						<reset_cue cue="this" />
					</actions>
				</cue>
				
				<!-- MINISTRY DTO - Couldnt use "min" for thiscue, because its a reserved key word -->
				<cue name="ministry" instantiate="true">
					<conditions>
						<event_cue_signalled />
					</conditions>
					<actions>
						<set_value name="$Faction" exact="faction.ministry" />
						<debug_text text="'ForceRepresentative - in DTO for for : ' + $Faction" />
						<set_value name="$SearchSpace" exact="player.galaxy" />
						<!-- this cue will serve to store every variable in next called cues -->
						<signal_cue_instantly cue="spawn" param="namespace" />
						<reset_cue cue="this" />
					</actions>
				</cue>
				
				<!-- SCALEPLATE DTO -->
				<cue name="sca" instantiate="true">
					<conditions>
						<event_cue_signalled />
					</conditions>
					<actions>
						<set_value name="$Faction" exact="faction.scaleplate" />
						<debug_text text="'ForceRepresentative - in DTO for for : ' + $Faction" />
						<set_value name="$SearchSpace" exact="player.galaxy" />
						<!-- this cue will serve to store every variable in next called cues -->
						<signal_cue_instantly cue="spawn" param="namespace" />
						<reset_cue cue="this" />
					</actions>
				</cue>
				
				<!-- PARANID DTO -->
				<cue name="par" instantiate="true">
					<conditions>
						<event_cue_signalled />
					</conditions>
					<actions>
						<set_value name="$Faction" exact="faction.paranid" />
						<debug_text text="'ForceRepresentative - in DTO for for : ' + $Faction" />
						<set_value name="$SearchSpace" exact="player.galaxy" />
						<!-- this cue will serve to store every variable in next called cues -->
						<signal_cue_instantly cue="spawn" param="namespace" />
						<reset_cue cue="this" />
					</actions>
				</cue>
				
				<!-- HOLY ORDER DTO -->
				<cue name="hop" instantiate="true">
					<conditions>
						<event_cue_signalled />
					</conditions>
					<actions>
						<set_value name="$Faction" exact="faction.holyorder" />
						<debug_text text="'ForceRepresentative - in DTO for for : ' + $Faction" />
						<set_value name="$SearchSpace" exact="player.galaxy" />
						<!-- this cue will serve to store every variable in next called cues -->
						<signal_cue_instantly cue="spawn" param="namespace" />
						<reset_cue cue="this" />
					</actions>
				</cue>
				
				<!-- ALLIANCE DTO -->
				<cue name="ali" instantiate="true">
					<conditions>
						<event_cue_signalled />
					</conditions>
					<actions>
						<set_value name="$Faction" exact="faction.alliance" />
						<debug_text text="'ForceRepresentative - in DTO for for : ' + $Faction" />
						<set_value name="$SearchSpace" exact="player.galaxy" />
						<!-- this cue will serve to store every variable in next called cues -->
						<signal_cue_instantly cue="spawn" param="namespace" />
						<reset_cue cue="this" />
					</actions>
				</cue>
				
				<!-- XENON DTO -> WILL NOT BE USED !!! If someone call this, the Xenon will probably get a representative (lol) -->
				<cue name="xen" instantiate="true">
					<conditions>
						<event_cue_signalled />
					</conditions>
					<actions>
						<set_value name="$Faction" exact="faction.xenon" />
						<debug_text text="'ForceRepresentative - in DTO for for : ' + $Faction" />
						<set_value name="$SearchSpace" exact="player.galaxy" />
						<!-- this cue will serve to store every variable in next called cues -->
						<signal_cue_instantly cue="spawn" param="namespace" />
						<reset_cue cue="this" />
					</actions>
				</cue>
				
				<!-- BUCCANEERS DTO -->
				<cue name="duk" instantiate="true">
					<conditions>
						<event_cue_signalled />
					</conditions>
					<actions>
						<set_value name="$Faction" exact="faction.buccaneers" />
						<debug_text text="'ForceRepresentative - in DTO for for : ' + $Faction" />
						<set_value name="$SearchSpace" exact="player.galaxy" />
						<!-- this cue will serve to store every variable in next called cues -->
						<signal_cue_instantly cue="spawn" param="namespace" />
						<reset_cue cue="this" />
					</actions>
				</cue>
				
				<!-- TRINITY DTO -->
				<cue name="tri" instantiate="true">
					<conditions>
						<event_cue_signalled />
					</conditions>
					<actions>
						<set_value name="$Faction" exact="faction.trinity" />
						<debug_text text="'ForceRepresentative - in DTO for for : ' + $Faction" />
						<set_value name="$SearchSpace" exact="player.galaxy" />
						<!-- this cue will serve to store every variable in next called cues -->
						<signal_cue_instantly cue="spawn" param="namespace" />
						<reset_cue cue="this" />
					</actions>
				</cue>
				
				<!-- ZYARTH DTO -->
				<cue name="zya" instantiate="true">
					<conditions>
						<event_cue_signalled />
					</conditions>
					<actions>
						<set_value name="$Faction" exact="faction.split" />
						<debug_text text="'ForceRepresentative - in DTO for for : ' + $Faction" />
						<set_value name="$SearchSpace" exact="player.galaxy" />
						<!-- this cue will serve to store every variable in next called cues -->
						<signal_cue_instantly cue="spawn" param="namespace" />
						<reset_cue cue="this" />
					</actions>
				</cue>
				
				<!-- FREE FAMILIES DTO -->
				<cue name="frf" instantiate="true">
					<conditions>
						<event_cue_signalled />
					</conditions>
					<actions>
						<set_value name="$Faction" exact="faction.freesplit" />
						<debug_text text="'ForceRepresentative - in DTO for for : ' + $Faction" />
						<set_value name="$SearchSpace" exact="player.galaxy" />
						<!-- this cue will serve to store every variable in next called cues -->
						<signal_cue_instantly cue="spawn" param="namespace" />
						<reset_cue cue="this" />
					</actions>
				</cue>
				
				<!-- COURT OF CURBS DTO -->
				<cue name="cub" instantiate="true">
					<conditions>
						<event_cue_signalled />
					</conditions>
					<actions>
						<set_value name="$Faction" exact="faction.court" />
						<debug_text text="'ForceRepresentative - in DTO for for : ' + $Faction" />
						<set_value name="$SearchSpace" exact="player.galaxy" />
						<!-- this cue will serve to store every variable in next called cues -->
						<signal_cue_instantly cue="spawn" param="namespace" />
						<reset_cue cue="this" />
					</actions>
				</cue>
				
				<!-- FALLEN FAMILIES DTO -->
				<cue name="faf" instantiate="true">
					<conditions>
						<event_cue_signalled />
					</conditions>
					<actions>
						<set_value name="$Faction" exact="faction.fallensplit" />
						<debug_text text="'ForceRepresentative - in DTO for for : ' + $Faction" />
						<set_value name="$SearchSpace" exact="player.galaxy" />
						<!-- this cue will serve to store every variable in next called cues -->
						<signal_cue_instantly cue="spawn" param="namespace" />
						<reset_cue cue="this" />
					</actions>
				</cue>
				
				<!-- TERRAN DTO -->
				<cue name="ter" instantiate="true">
					<conditions>
						<event_cue_signalled />
					</conditions>
					<actions>
						<set_value name="$Faction" exact="faction.terran" />
						<debug_text text="'ForceRepresentative - in DTO for for : ' + $Faction" />
						<set_value name="$SearchSpace" exact="player.galaxy" />
						<!-- this cue will serve to store every variable in next called cues -->
						<signal_cue_instantly cue="spawn" param="namespace" />
						<reset_cue cue="this" />
					</actions>
				</cue>
				
				<!-- PIONEERS DTO -->
				<cue name="pio" instantiate="true">
					<conditions>
						<event_cue_signalled />
					</conditions>
					<actions>
						<set_value name="$Faction" exact="faction.pioneers" />
						<debug_text text="'ForceRepresentative - in DTO for for : ' + $Faction" />
						<set_value name="$SearchSpace" exact="player.galaxy" />
						<!-- this cue will serve to store every variable in next called cues -->
						<signal_cue_instantly cue="spawn" param="namespace" />
						<reset_cue cue="this" />
					</actions>
				</cue>
				
				<!-- YAKI DTO -->
				<cue name="yak" instantiate="true">
					<conditions>
						<event_cue_signalled />
					</conditions>
					<actions>
						<set_value name="$Faction" exact="faction.yaki" />
						<debug_text text="'ForceRepresentative - in DTO for for : ' + $Faction" />
						<set_value name="$SearchSpace" exact="player.galaxy" />
						<!-- this cue will serve to store every variable in next called cues -->
						<signal_cue_instantly cue="spawn" param="namespace" />
						<reset_cue cue="this" />
					</actions>
				</cue>
				
				<!-- VIGOR SYNDICATE DTO -->
				<cue name="vig" instantiate="true">
					<conditions>
						<event_cue_signalled />
					</conditions>
					<actions>
						<set_value name="$Faction" exact="faction.loanshark" />
						<debug_text text="'ForceRepresentative - in DTO for for : ' + $Faction" />
						<set_value name="$SearchSpace" exact="player.galaxy" />
						<!-- this cue will serve to store every variable in next called cues -->
						<signal_cue_instantly cue="spawn" param="namespace" />
						<reset_cue cue="this" />
					</actions>
				</cue>
				
				<!-- RIPTIDE RACKERS DTO -->
				<cue name="rip" instantiate="true">
					<conditions>
						<event_cue_signalled />
					</conditions>
					<actions>
						<set_value name="$Faction" exact="faction.scavenger" />
						<debug_text text="'ForceRepresentative - in DTO for for : ' + $Faction" />
						<set_value name="$SearchSpace" exact="player.galaxy" />
						<!-- this cue will serve to store every variable in next called cues -->
						<signal_cue_instantly cue="spawn" param="namespace" />
						<reset_cue cue="this" />
					</actions>
				</cue>
				
				<!-- BORON DTO -->
				<cue name="bor" instantiate="true">
					<conditions>
						<event_cue_signalled />
					</conditions>
					<actions>
						<set_value name="$Faction" exact="faction.boron" />
						<debug_text text="'ForceRepresentative - in DTO for for : ' + $Faction" />
						<set_value name="$SearchSpace" exact="player.galaxy" />
						<!-- this cue will serve to store every variable in next called cues -->
						<signal_cue_instantly cue="spawn" param="namespace" />
						<reset_cue cue="this" />
					</actions>
				</cue>
				
				<!-- QUETTANAUTS DTO -->
				<cue name="que" instantiate="true">
					<conditions>
						<event_cue_signalled />
					</conditions>
					<actions>
						<set_value name="$Faction" exact="faction.kaori" />
						<debug_text text="'ForceRepresentative - in DTO for for : ' + $Faction" />
						<set_value name="$SearchSpace" exact="player.galaxy" />
						<!-- this cue will serve to store every variable in next called cues -->
						<signal_cue_instantly cue="spawn" param="namespace" />
						<reset_cue cue="this" />
					</actions>
				</cue>

				<!-- ====================== LOGICAL CODE, MUST ME CALLED FROM A "DTO" CUE ABOVE ====================== -->
				<!-- force spawn representative, need to instanciate to trigger the cue everytime its called -->
				<cue name="spawn" instantiate="true">
					<conditions>
						<event_cue_signalled />
					</conditions>
					<actions>
						<!-- extend scope to parent namespace (frf or other faction diminitive) -->
						<set_value name="$Super" exact="event.param" />
						<!-- get the $Faction value from the calling cue or lib -->
						<set_value name="$Faction" exact="$Super.$Faction" />
						<!-- get the $SearchSpace value from the calling cue or lib -->
						<set_value name="$SearchSpace" exact="$Super.$SearchSpace" />
						<!-- get the $FactionLogic value from the calling cue or lib -->
						<!-- <set_value name="$FactionLogic" exact="$Super.$FactionLogic" /> -->
						
						<!-- dabug, start script -->
						<debug_text text="'ForceRepresentative - Received an instruction to check representative for : ' + $Faction" />
						<debug_text text="'ForceRepresentative - ' + $Faction.name + ' check'" />

						<do_if value="not $Faction.representative.exists and $Faction.isactive">
							<!-- Rep Missing -->
							<show_notification text="'MRTF SITREP: ' + $Faction.name + ' representative missing'"/>
							<debug_text text="'ForceRepresentative - ' + $Faction.name + ' representative missing, trying to relocate HQ'" />
							<!-- Trying to find new HQ with the game methods, do not work ATM @todo : find a way to access library methods -->
							<!-- <signal_cue_instantly cue="$FactionLogic.RelocateHQ" /> -->
							<!-- <signal_cue_instantly cue="$FactionLogic.CreateNewFactionRepresentative" /> -->
							
							<!-- Recheck, if the game has detected the missing Representative -->
							<do_if value="not $Faction.representative.exists">
								<debug_text text="'ForceRepresentative - ' + $Faction.name + ' forced HQ reset didnt solved the problem'" />
								<!-- if representative still do not exists, we change the HQ no matter what -->
								<!-- <find_station_by_true_owner name="$HQ" space="$SearchSpace" faction="$Faction" /> -->
								
								<find_station name="$Super.$HQ" space="$SearchSpace" owner="$Faction"/>
								<do_if value="$Super.$HQ and $Super.$HQ.isoperational">
									<!-- setting up the new HQ, extending data scope -->
									<set_value name="md.$FactionData.{$Faction}.$Headquarters" exact="$Super.$HQ" />
									<!-- and then we create the representative -->
									<create_representative_actor name="$Super.$Representative" station="$Super.$HQ" faction="$Faction" />
									<!-- create room and place npc, pass super to store global variable un super -->
									<signal_cue_instantly cue="make_room" param="$Super.namespace" />
									<reset_cue cue="make_room" />
									<!-- extending data scope -->
									<set_value name="md.$FactionData.{$Faction}.$Representative" exact="$Super.$Representative" />
									<!-- notify the game that we have placed a new representative (for the conversation handler to be able to handle conversation with the player) -->
									<!--  , do not work ATM @todo : find a way to access library methods -->
									<!-- <signal_cue_instantly cue="md.NPC_FactionRepresentative.Handler_FactionRepresentative.FactionRepresentativeCreated" param="$Representative" check="false" /> -->
								</do_if>
								<do_else>
									<!-- we didnt find any eligible station -->
									<debug_text text="'ForceRepresentative - ' + $Faction.name + ' representative cant find HQ'"  filter="error" />
								</do_else>
							</do_if>
							<!-- Last check if representative exists and have a roomm where we can find hem -->
							<do_if value="not $Faction.representative.exists" >
								<show_notification text="'MRTF SITREP: ' + $Faction.name + ' representative unreachable'" />
								<debug_text text="'ForceRepresentative - Cant spawn ' + $Faction.name + '  Representative'"  filter="error" />
							</do_if>
							<do_else>
								<!-- we made the representative respawned -->
								<show_notification text="'MRTF SITREP: ' + $Faction.name + ' representative recovered'"/>
								<debug_text text="'ForceRepresentative - ' + $Faction.name + ' representative spawned'" />
							</do_else>
						</do_if>
						<do_else>
							<!-- if representative already exists, we do nothing -->
							<debug_text text="'ForceRepresentative - ' + $Faction.name + ' representative already exists or faction is not active'" />
						</do_else>
						<reset_cue cue="this" />
					</actions>
				</cue>
				
				<!-- create a room on designated station for representative, need to instanciate to trigger the cue everytime its called -->
				<cue name="make_room"  instantiate="true">
					<conditions>
						<event_cue_signalled />
					</conditions>
					<actions>
						<!-- extend scope to parent namespace (spawn.super) -->
						<set_value name="$Super" exact="event.param" />
						<!-- get the $Faction value from the calling cue -->
						<set_value name="$Faction" exact="$Super.$Faction" />
						<!-- get the $HQ value from the calling cue -->
						<set_value name="$HQ" exact="$Super.$HQ" />
						<!-- get the $Representative value from the calling cue -->
						<set_value name="$Representative" exact="$Super.$Representative" />
						
						<debug_text text="'ForceRepresentative - Create room for ' + $Faction.name + '  Representative'" />
						<!-- In most case, if the representative wasnt in the universe, he doesnt have any room to sit, this script (almost Vanilla) will make a romm on designated station -->
						<set_value name="$Race" exact="$HQ.owner.primaryrace" />
						<set_value name="$InteriorSeed" exact="$HQ.seed + lookup.roomtype.list.indexof.{roomtype.factionrep}"/>

						<!-- Logical --> 
						<get_room_definition macro="$CorridorMacro" race="$Race" tags="tag.administrationcorridor" seed="$InteriorSeed" />
						<do_if value="not $CorridorMacro">
							<get_room_definition macro="$CorridorMacro" race="$Race" tags="tag.corridor" seed="$InteriorSeed" />
						</do_if>
						<get_room_definition macro="$RoomMacro" doors="$RoomDoors" race="$Race" tags="tag.factionrep" seed="$InteriorSeed" />
						<!-- Create room -->
						<substitute_text text="$InteriorName" source="readtext.{30003}.{10004}">
							<replace string="'$FACTION$'" with="$Faction.name" />
						</substitute_text>
						<create_dynamic_interior object="$HQ" corridor="$CorridorMacro" room="$RoomMacro" name="$InteriorName" interiorname="$Interior" corridorname="$Corridor" roomname="$Room" roomtype="roomtype.factionrep" seed="$InteriorSeed" />
						<do_if value="$Interior and $Corridor and $Room">
							<!-- Create room -->
							<debug_text text="'ForceRepresentative - Interior for ' + $Representative.name + ' created'" />
							<find_npc_slot name="$NPCSlot" object="$Room" tags="tag.control"/>
							<do_if value="not $NPCSlot">
								<find_npc_slot name="$NPCSlot" object="$Room" />
							</do_if>
							<do_if value="$NPCSlot">
								<!-- Place faction representative -->
								<add_actor_to_room actor="$Representative" slot="$NPCSlot" />
								<debug_text text="'ForceRepresentative - Representative ' + $Representative.name + ' added to room ' + $Room + ' (' + $RoomMacro + ')'" />
							</do_if>
							<do_else>
								<debug_text text="'ForceRepresentative - Could not find slot for ' + $Representative.name + ' ({' + $Representative + '}) in ' + $Room + '(' + $RoomMacro + ')'" filter="error" />
							</do_else>
						</do_if>
						<do_else>
							<debug_text text="'ForceRepresentative - Interior for ' + $Representative.name + ' could not be created using $CorridorMacro: ' + $CorridorMacro + ' and $RoomMacro: ' + $RoomMacro" filter="error" />
						</do_else>
						<reset_cue cue="this" />
					</actions>
				</cue>
			</cues>
		</cue>
	</cues>
</mdscript>